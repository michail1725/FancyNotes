@page "/NotesObserver"
@using FancyNotes.Client.Services.Contracts;
@using FancyNotes.Infrastructure;
@using FancyNotes.Shared;
@attribute [Authorize]


<h3>NotesObserverPage</h3>
<MudButton Variant="Variant.Filled" OnClick="OpenNoteEditor">Создать заметку</MudButton>

@code {
    [Inject] ILocalStorageService localStorageService { get; set; }
    [Inject] NavigationManager NavigationManager { get; set; }
    [Inject] INoteClientService NoteClientService { get; set; }

    public List<Note> noteList { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await LoadNoteList();
    }

    private async Task LoadNoteList()
    {
        UserSession storagedData = await localStorageService.GetItemAsync<UserSession>("UserSession");

        var notes = await NoteClientService.GetNotesList(storagedData.Id);
        noteList = notes.ToList();
    }

    public void OpenNoteEditor(int noteId)
    {
        NavigationManager.NavigateTo($"/NoteEditor/{noteId}", true);
    }

    public void OpenNoteEditor()
    {
        NavigationManager.NavigateTo($"/NoteEditor", true);
    }

    
}
